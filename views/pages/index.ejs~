<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="/stylesheets/wdm.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="http://maps.googleapis.com/maps/api/js?libraries=places"></script>

<script>
$(document).ready(function(){
	$('#div1').hide();
	$('#mapdiv').hide();
	var location = [];
	$("#getstats").click(function(){
		var dburl = "https://frozen-plateau-15908.herokuapp.com/db";

        	$.get(dburl, function(response){
        		//alert(response);
			$('#div1').show();
			var trHTML = '';
	        	$.each(response.results, function (i, item) {
				location.push(item.location);
        	    		trHTML += '<tr><td>' + item.race + '</td><td>' + item.gp + '</td><td>' + item.location + '</td><td>' + item.date + '</td><td>' + item.winner + '</td><td>' + item.team + '</td></tr>';
        		});
	        	$('#div1 table').append(trHTML);
			$('#div1').show();
        	});
    	});

	$("#map").click(function(){
			$('#mapdiv').show();
 			// Create a map object and specify the DOM element for display.
  			var map = new google.maps.Map(document.getElementById("mapdiv"), {
    				center: {lat: 0, lng: 0},
    				scrollwheel: false,
    				zoom: 1
  			});
			for (var x = 0; x < location.length; x++) {
	        	$.getJSON('http://maps.googleapis.com/maps/api/geocode/json?address='+addresses[x]+'&sensor=false', null, function (data) {
        	    	var p = data.results[0].geometry.location
            		var latlng = new google.maps.LatLng(p.lat, p.lng);
            		new google.maps.Marker({
                	position: latlng,
                	map: map
 	           });

        });
    }
	});

});
</script>
</head>
    <body>

        <div class="main-container">

            <!-- HEADER -->
            <header class="block">
		<ul class="header-menu horizontal-list">		
			<li>
			<div class="profile-menu">
                    		<div class="profile-picture small-profile-picture">
                        		<img width="80px" alt="picture" src="1.jpg">
                    		</div>
                	</div>
			</li>

			<li>
               			<h1>FORMULA 1 2015 <a href="#26"></a></h1>
			</li>
		</ul>
            </header>
	
	<div class="donut-chart-block block"> 
        	<h2 class="titular">Season 2015 - 2016 STATS</h2>
		<p>
			This is CSE 5335 Spring 2016 Project 1. This is a web application that shows team based stats of the last F1 season. The data is received as json objects. 
		</p>
	</div>
	
	
	<a id ="getstats" class="subscribe button">Get Stats</a>
	<!-- <button>Get Stats</button> -->
	<div id="div1"  class="loading block">
        <table style="width:100%; color:white">
  		<tr>
	  	<td>Race</td>	
		<td>Grand Prix</td>
		<td>Location</td>
		<td>Date</td>
	 	<td>Winner</td>
		<td>Team</td>
		</tr>
	 </table>
	 <a id ="map" class="subscribe button">Visualize</a>
	</div>
	<div id="mapdiv"  class="loading block">
	
	</div>

    </body>
</html>
